# –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∫–æ–¥–∞ Majority Game

## üõ†Ô∏è –û–±—â–∏–µ –º–æ–¥—É–ª–∏

–í—Å–µ –æ–±—â–∏–µ –º–æ–¥—É–ª–∏ –Ω–∞—Ö–æ–¥—è—Ç—Å—è –≤ `server/static/` –∏ **–∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö –∏–≥—Ä—ã**.

### 1. `game-logic.js`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –Ø–¥—Ä–æ –∏–≥—Ä–æ–≤–æ–π –ª–æ–≥–∏–∫–∏ –∏ –ø—Ä–∞–≤–∏–ª –∏–≥—Ä—ã.

**–§—É–Ω–∫—Ü–∏–∏:**
- `neighbors(r, c, N)` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç 8 —Å–æ—Å–µ–¥–µ–π –∫–ª–µ—Ç–∫–∏
- `countAround(board, r, c, playerNum)` - —Å—á–∏—Ç–∞–µ—Ç —Å–æ—Å–µ–¥–µ–π —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏–≥—Ä–æ–∫–∞
- `getEmptyCells(board)` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –ø—É—Å—Ç—ã–µ –∫–ª–µ—Ç–∫–∏
- `getLegalCells(board, player)` - –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Ö–æ–¥—ã (—Å —É—á—ë—Ç–æ–º —Ä–∞–Ω–Ω–µ–π –∏–≥—Ä—ã)
- `calculateCascadeWaves(initialBoard, moveR, moveC, player, cascadeOn)` - –≤—ã—á–∏—Å–ª—è–µ—Ç –≤–æ–ª–Ω—ã –∫–∞—Å–∫–∞–¥–Ω—ã—Ö –∑–∞—Ö–≤–∞—Ç–æ–≤
- `simulateMove(board, r, c, player, cascadeOn)` - —Å–∏–º—É–ª—è—Ü–∏—è —Ö–æ–¥–∞ –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–æ—Å–∫–∏ (–¥–ª—è –ò–ò)
- `boardScore(board, player)` - –æ—Ü–µ–Ω–∫–∞ –ø–æ–∑–∏—Ü–∏–∏
- `evaluate(board, player)` - –ø—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è –æ—Ü–µ–Ω–∫–∞ –¥–ª—è –ò–ò

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- ‚úÖ `singleplayer.html` (–æ–¥–∏–Ω–æ—á–Ω–∞—è –∏–≥—Ä–∞)
- ‚úÖ `game.html` (–º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä)
- ‚úÖ `ai.js` (–ª–æ–≥–∏–∫–∞ –ò–ò)

---

### 2. `animations.js`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –í—Å–µ –∞–Ω–∏–º–∞—Ü–∏–∏ –∏ –≤–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã.

**–§—É–Ω–∫—Ü–∏–∏:**
- `getCell(r, c)` - –ø–æ–ª—É—á–µ–Ω–∏–µ DOM —ç–ª–µ–º–µ–Ω—Ç–∞ –∫–ª–µ—Ç–∫–∏
- `updateCellVisual(board, r, c, animate)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–∏–∑—É–∞–ª–∞ –∫–ª–µ—Ç–∫–∏ + –∞–Ω–∏–º–∞—Ü–∏—è flip
- `updateThreats(board)` - –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ —É–≥—Ä–æ–∑—ã "!"
- `lockBoard(lock)` - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–æ—Å–∫–∏
- **`applyMoveWithAnimation(board, r, c, player, cascadeOn)`** - –ü–†–ò–ú–ï–ù–Ø–ï–¢ –•–û–î –° –ê–ù–ò–ú–ê–¶–ò–ï–ô –ö–ê–°–ö–ê–î–ê
  - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ –≤ –º—Å
  - –ü—Ä–∏–º–µ–Ω—è–µ—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫ `board` –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ
- `renderBoard(N)` - —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Ç–∫—É –¥–æ—Å–∫–∏

**–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∞–Ω–∏–º–∞—Ü–∏–∏:**
```javascript
DOT_TIME   = 400–º—Å   // –≤—Ä–µ–º—è –ø–æ–∫–∞–∑–∞ –±–µ–ª—ã—Ö —Ç–æ—á–µ–∫
FLIP_GAP   = 150/80–º—Å // –∑–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –ø–µ—Ä–µ–≤–æ—Ä–æ—Ç–∞–º–∏
WAVE_PAUSE = 250–º—Å   // –ø–∞—É–∑–∞ –º–µ–∂–¥—É –≤–æ–ª–Ω–∞–º–∏
```

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- ‚úÖ `singleplayer.html`
- ‚ùå `game.html` (–∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—É—é –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è 5 –∏–≥—Ä–æ–∫–æ–≤)

---

### 3. `ai.js`

**–û–ø–∏—Å–∞–Ω–∏–µ:** –õ–æ–≥–∏–∫–∞ –ò–ò –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω–æ–π –∏–≥—Ä—ã.

**–§—É–Ω–∫—Ü–∏–∏:**
- `aiEasy(board, cascadeOn)` - –ø—Ä–æ—Å—Ç–æ–π greedy –∞–ª–≥–æ—Ä–∏—Ç–º
- `aiMedium(board, cascadeOn)` - —Ç–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ò–ò —Å —ç–≤—Ä–∏—Å—Ç–∏–∫–∞–º–∏
- `aiHard(board, cascadeOn)` - lookahead —Å –º–∏–Ω–∏–º–∞–∫—Å–æ–º
- `aiMove(board, diffIdx, cascadeOn, callback)` - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è —Ö–æ–¥–∞ –ò–ò

**–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:**
- ‚úÖ `singleplayer.html`

---

## üìù –†–µ–∂–∏–º—ã –∏–≥—Ä—ã

### 1. –û–¥–∏–Ω–æ—á–Ω–∞—è –∏–≥—Ä–∞ (`singleplayer.html`)

**–ü–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:**
```html
<script src="/static/game-logic.js"></script>
<script src="/static/animations.js"></script>
<script src="/static/ai.js"></script>
```

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞:**
- 2 –∏–≥—Ä–æ–∫–∞: —á–µ–ª–æ–≤–µ–∫ (p1) vs –ò–ò (p2)
- –†–∞–∑–º–µ—Ä—ã –ø–æ–ª—è: 6√ó6, 8√ó8, 10√ó10, 16√ó16
- 3 —É—Ä–æ–≤–Ω—è —Å–ª–æ–∂–Ω–æ—Å—Ç–∏ –ò–ò
- –õ–æ–∫–∞–ª—å–Ω–∞—è –∏–≥—Ä–∞ (–±–µ–∑ —Å–µ—Ä–≤–µ—Ä–∞)

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `onCellClick(r, c)` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Ö–æ–¥–∞ —á–µ–ª–æ–≤–µ–∫–∞
- `makeAIMove()` - –∑–∞–ø—É—Å–∫ —Ö–æ–¥–∞ –ò–ò
- `initGame()` - –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∏–≥—Ä—ã

---

### 2. –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä (`game.html`)

**–ü–æ–¥–∫–ª—é—á—ë–Ω–Ω—ã–µ –º–æ–¥—É–ª–∏:**
```html
<script src="/static/game-logic.js"></script>
```

**–°–ø–µ—Ü–∏—Ñ–∏–∫–∞:**
- 2-5 –∏–≥—Ä–æ–∫–æ–≤
- –°–µ—Ç–µ–≤–∞—è –∏–≥—Ä–∞ —á–µ—Ä–µ–∑ Flask API
- –û–ø—Ä–æ—Å —Å–µ—Ä–≤–µ—Ä–∞ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É

**–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `updateThreatsMultiplayer()` - —É—á–∏—Ç—ã–≤–∞–µ—Ç –¥–æ 5 –∏–≥—Ä–æ–∫–æ–≤
- `calculateCascadeWavesMultiplayer()` - –∫–∞—Å–∫–∞–¥ –¥–ª—è 5 –∏–≥—Ä–æ–∫–æ–≤
- `renderBoardWithAnimation()` - –∫–∞—Å—Ç–æ–º–Ω–∞—è –∞–Ω–∏–º–∞—Ü–∏—è

**–ö–ª—é—á–µ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- `refresh()` - –æ–ø—Ä–æ—Å —Å–µ—Ä–≤–µ—Ä–∞
- `onCellClick(r, c)` - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Ö–æ–¥–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä
- `renderPlayers()` - –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏–≥—Ä–æ–∫–æ–≤

---

## ‚ú® –ö–∞–∫ –¥–æ–±–∞–≤–∏—Ç—å –Ω–æ–≤—É—é —Ñ–∏—á—É

### üîπ –ï—Å–ª–∏ —Ñ–∏—á–∞ –¥–ª—è **–æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–æ–≤**:

1. **–ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞** ‚Üí —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `game-logic.js`
2. **–ê–Ω–∏–º–∞—Ü–∏–∏** ‚Üí —Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `animations.js`
3. **–°—Ç–∏–ª–∏ (CSS)** ‚Üí –¥–æ–±–∞–≤—å—Ç–µ –≤ `<style>` —Å–µ–∫—Ü–∏—é –æ–±–æ–∏—Ö —Ñ–∞–π–ª–æ–≤

‚úÖ **–ò–∑–º–µ–Ω–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—Ç—Å—è –≤–µ–∑–¥–µ!**

### üîπ –ï—Å–ª–∏ —Ñ–∏—á–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è **–æ–¥–∏–Ω–æ—á–Ω–æ–π –∏–≥—Ä—ã**:

–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `singleplayer.html` –∏–ª–∏ `ai.js`

### üîπ –ï—Å–ª–∏ —Ñ–∏—á–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è **–º—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä–∞**:

–†–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ `game.html` –∏–ª–∏ `game_engine.py`

---

## üìä –ü—Ä–∏–º–µ—Ä: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏

### 1. –î–æ–±–∞–≤—å—Ç–µ CSS –≤ –æ–±–∞ —Ñ–∞–π–ª–∞:

```css
/* –í singleplayer.html –∏ game.html */
.cell.highlight {
  box-shadow: 0 0 20px #ffff00aa;
  animation: glow 0.5s infinite alternate;
}

@keyframes glow {
  from { filter: brightness(1); }
  to { filter: brightness(1.5); }
}
```

### 2. –î–æ–±–∞–≤—å—Ç–µ –ª–æ–≥–∏–∫—É –≤ `animations.js`:

```javascript
function highlightCell(r, c, duration = 1000) {
  const cell = getCell(r, c);
  if (cell) {
    cell.classList.add('highlight');
    setTimeout(() => cell.classList.remove('highlight'), duration);
  }
}
```

### 3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö:

```javascript
// –í singleplayer.html
highlightCell(r, c);

// –í game.html
highlightCell(r, c);
```

‚úÖ **–†–∞–±–æ—Ç–∞–µ—Ç —Å—Ä–∞–∑—É –≤ –æ–±–æ–∏—Ö —Ä–µ–∂–∏–º–∞—Ö!**

---

## ‚ö†Ô∏è –í–∞–∂–Ω–æ

1. **–ù–µ –¥—É–±–ª–∏—Ä—É–π—Ç–µ –∫–æ–¥** - –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±—â–∏–µ –º–æ–¥—É–ª–∏
2. **–¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±–∞ —Ä–µ–∂–∏–º–∞** –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –æ–±—â–∏—Ö –º–æ–¥—É–ª—è—Ö
3. **–ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä —Å–ø–µ—Ü–∏—Ñ–∏—á–µ–Ω** - –Ω–µ –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å (5 –∏–≥—Ä–æ–∫–æ–≤ vs 2)

---

## üö¶ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
majority_game/
‚îú‚îÄ‚îÄ server/
‚îÇ   ‚îú‚îÄ‚îÄ static/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ game-logic.js    ‚úÖ –û–±—â–∏–π - –ò–≥—Ä–æ–≤–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ animations.js    ‚úÖ –û–±—â–∏–π - –ê–Ω–∏–º–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ai.js            ü§ñ –¢–æ–ª—å–∫–æ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω–æ–π
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ app.css
‚îÇ   ‚îú‚îÄ‚îÄ templates/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ index.html       üè† –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ singleplayer.html  ü§ñ –û–¥–∏–Ω–æ—á–Ω–∞—è –∏–≥—Ä–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ game.html        üë• –ú—É–ª—å—Ç–∏–ø–ª–µ–µ—Ä
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ lobby.html
‚îÇ   ‚îú‚îÄ‚îÄ app.py             üåê Flask —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îú‚îÄ‚îÄ game_engine.py     ‚öôÔ∏è –î–≤–∏–∂–æ–∫ –∏–≥—Ä—ã (—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –ª–æ–≥–∏–∫–∞)
‚îÇ   ‚îî‚îÄ‚îÄ lobby_store.py
‚îî‚îÄ‚îÄ run.py
```

---

**üöÄ –¢–µ–ø–µ—Ä—å –ª—é–±—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –æ–±—â–∏—Ö –º–æ–¥—É–ª—è—Ö –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –∫ –æ–±–æ–∏–º —Ä–µ–∂–∏–º–∞–º –∏–≥—Ä—ã!**
